import{C as e,_ as l}from"./CouponsForm.vue_vue_type_script_setup_true_lang-BjBZIzTU.js";import{_ as s,a as o,b as t,c as a}from"./ConfirmModal.vue_vue_type_script_setup_true_lang-CMNdRJV8.js";import{d as i,r as n,a as r,Q as u,k as d,S as c,n as m,z as p,c as v,v as _,x,y as f,E as h,G as j,T as C,L as g,R as y,U as w,V as b,W as E,H as k}from"./index-D0wN_fuZ.js";import{M as R}from"./index-BZUQu6cJ.js";import{_ as M,B as S}from"./index-DK-IiT8x.js";import{I as A}from"./index-_uS1yxUQ.js";import{_ as L,M as B}from"./index-BQa5vSjM.js";import{_ as D,a as V}from"./dropdown-DdxiuV_U.js";import"./RForm.vue_vue_type_script_setup_true_lang-HqTuq9xx.js";import"./index-BtQlog3F.js";import"./RestBase-6hwWqa7t.js";import"./createContext-Cl9SgfpP.js";import"./FormItemContext-CfbnWjAK.js";import"./index-CFoXpmaN.js";import"./debounceValidator-Cl5zTG4a.js";import"./index-brT4NzTB.js";import"./RButton.vue_vue_type_style_index_0_lang-DWca47Ax.js";import"./REditor.vue_vue_type_style_index_0_lang-B9q55COs.js";import"./useValidation-Dimmn3XB.js";import"./RSelect.vue_vue_type_script_setup_true_lang-C-HhWqQ_.js";import"./ClearButton-D4yBJSZU.js";import"./index-D-OtIBMI.js";import"./usePopupContainer-BObfUw_y.js";import"./types.model-BWjGDeTh.js";import"./colors-Bmc914HC.js";import"./supportsPassive-pertglWR.js";import"./index-C2qDfXmS.js";import"./useMergedState-BcJwUeRJ.js";import"./KeyCode-BFt-2P2l.js";import"./styleChecker-CGBUfLOL.js";import"./index-BstQ-YzR.js";import"./index-DtiMcqIf.js";import"./debounce-Cg7NfA5c.js";import"./collapseMotion-BM3-mHdV.js";import"./LeftOutlined-BPCL5cU7.js";import"./isMobile-VPrdNIIw.js";import"./useMemo-CnyBa7eu.js";import"./DownOutlined-DYgTl6g-.js";import"./index-ChnaMK_j.js";import"./EyeOutlined-DOQragHS.js";import"./shallowequal-UQLE3OsX.js";const O=x("div",{class:"r-close-icon hoverable-close"},null,-1),F={class:"flex"},I=x("div",{class:"r-loading-default"},null,-1),q={class:"r-breadcumbs"},z=x("div",{class:"flex justify-center items-center"},[x("div",{class:"i-heroicons:home w-1em h-1em mr-1"}),x("p",null,"Inicio")],-1),K=x("div",null,[x("h1",{class:"mt-5"},"Cupones")],-1),P={class:"r-container-list"},T={class:"relative card w-full float-right"},U={class:""},H={class:"components-input-demo-presuffix mt-3 flex"},G=x("span",{class:"i-heroicons:trash-16-solid text-md mr-1 mb-1"},null,-1),X=x("span",{class:"i-heroicons:plus-16-solid text-lg mr-1 mb-1"},null,-1),N={class:"w-50% mr-20"},Q={class:"float-right align-middle"},W={class:"justify-start w-20%"},Y=x("div",{class:"i-mdi:search w-1em h-1em text-2xl"},null,-1),Z={class:"flex justify-end w-20%"},$=x("div",{class:"flex"},[x("div",{class:"i-mdi:export-variant w-1em h-1em text-xl mr-1"}),g(" Exportar ")],-1),J=x("span",{class:"flex"},[x("div",{class:"i-mdi:file-csv-outline w-1em h-1em text-gray-900 mr-2 text-xl"}),g(" CSV ")],-1),ee=x("span",{class:"flex"},[x("div",{class:"i-mdi:microsoft-excel w-1em h-1em text-green-700 mr-2 text-xl"}),g(" EXCEL ")],-1),le=x("span",{class:"flex"},[x("div",{class:"i-mdi:file-pdf-box w-1em h-1em text-red-500 mr-2 text-xl"}),g(" PDF ")],-1),se=["innerHTML"],oe={class:"flex justify-center align-center"},te={class:"text-xl flex justify-center align-center"},ae=["onClick"],ie=x("div",{class:"i-heroicons:trash w-1em h-1em text-red-600 cursor-pointer mt-1"},null,-1),ne=x("div",{class:"i-heroicons:trash w-1em h-1em text-red-600 cursor-pointer"},null,-1),re=i({__name:"CouponsList",setup(i){const re=n(),ue=n([]),de=n(null),ce=n(null),me=e.visible_columns,pe=r((()=>ue.value.filter((e=>u(e,re.value,me))))),{loading:ve,result:_e,onError:xe,onResult:fe,refetch:he}=e.useGetMany({relations:"all"}),je=d([]),{onError:Ce,onResult:ge,toggleEnabled:ye,loading:we,enabled:be}=e.useDeleteById(je,{defaultEnabled:!1});fe((e=>{ue.value=e.data.data})),xe((e=>{c("error","Error de peticion","Error de peticion del elemento")}));const Ee=n(!1),ke=(e=!1)=>{Ee.value=!Ee.value,e&&(R.destroyAll(),he())},Re=()=>{ce.value=null,ke()},Me=(e=!1)=>{ce.value=null,ke(e)};ge((()=>{var e;he(),null==(e=null==de?void 0:de.value)||e.clearSelection(),c("success","Acción Exitosa","Se han eliminado los elementos correctamente"),be.value=!1,R.destroyAll()}));const Se=()=>{R.confirm({title:v(t,{text:"¿Desea eliminar el/los elementos seleccionados?",iconClass:"i-heroicons:trash w-1em h-1em text-4xl color-red-500",textClass:"ml-5 text-xl",loading:we,onOk:()=>{var e;Object.assign(je,null==(e=null==de?void 0:de.value)?void 0:e.selectedRowKeys),ye()}}),icon:null,footer:null})},Ae=()=>{b("CouponsList",me,pe.value)},Le=()=>{E("CouponsList",me,pe.value)};return(t,i)=>{var n,r;const u=R,d=k("router-link"),b=M,E=S,ue=A,_e=L,xe=B,fe=D,je=V,Ce=a;return m(),p(w,null,[v(u,{open:h(Ee),"onUpdate:open":i[1]||(i[1]=e=>C(Ee)?Ee.value=e:null),footer:null,"destroy-on-close":!0,onCancel:i[2]||(i[2]=e=>ce.value=null),"wrap-class-name":"modal-form",width:"55%"},{closeIcon:_((()=>[O])),title:_((()=>[x("div",F,[x("div",{class:f([h(ce)?"i-heroicons:pencil-square":"i-heroicons:plus-20-solid","w-1em h-1em p-3.5 mr-2"])},null,2),x("h1",null,j(h(ce)?"Actualizar Cupones":"Crear Cupones"),1)])])),default:_((()=>[v(l,{modal:!0,modelValue:h(ce),"onUpdate:modelValue":i[0]||(i[0]=e=>C(ce)?ce.value=e:null),action:h(ce)?"update":"create",onCloseModal:Me,onReload:h(he),"show-loading":!0},{loading_icon:_((()=>[I])),_:1},8,["modelValue","action","onReload"])])),_:1},8,["open"]),x("div",q,[v(E,{class:"h-full"},{default:_((()=>[v(b,null,{default:_((()=>[v(d,{to:{name:"index"}},{default:_((()=>[z])),_:1})])),_:1}),v(b,null,{default:_((()=>[g("Sale")])),_:1}),v(b,null,{default:_((()=>[g("Cupones")])),_:1})])),_:1}),K]),x("div",P,[x("div",T,[x("div",U,[x("div",H,[v(h(y),{shadow:"",ref:"btnDelete",class:"btn-delete",disabled:0===(null==(n=h(de))?void 0:n.selectedRowKeys.length),onClick:Se},{default:_((()=>[G,g(" Eliminar ")])),_:1},8,["disabled"]),v(h(y),{class:"mr-3",shadow:"",onClick:Re},{default:_((()=>[X,g(" Crear Cupones ")])),_:1}),x("div",N,[x("span",Q,"Elementos seleccionados "+j(null==(r=h(de))?void 0:r.selectedRowKeys.length)+"/"+j(h(pe).length),1)]),x("div",W,[v(ue,{value:h(re),"onUpdate:value":i[3]||(i[3]=e=>C(re)?re.value=e:null),class:"col-1",placeholder:"Buscar elemento","allow-clear":!0},{prefix:_((()=>[Y])),_:1},8,["value"])]),x("div",Z,[v(fe,{class:"flex"},{overlay:_((()=>[v(xe,null,{default:_((()=>[v(_e,{key:"1",onClick:Ae},{default:_((()=>[J])),_:1}),v(_e,{key:"2",onClick:Le},{default:_((()=>[ee])),_:1}),v(_e,{key:"3"},{default:_((()=>[le])),_:1})])),_:1})])),default:_((()=>[$])),_:1})])])]),v(o,{ref_key:"couponsTbl",ref:de,columns:h(me),data:h(pe),loading_icon:h(ve),has_selection:!0,on_select:e=>{},onChangePagination:i[4]||(i[4]=e=>{h(he)()}),id_element:"id",expanded:!0,class:"mt-5"},{loading_icon:_((()=>[v(s)])),expandedRowRender:_((({record:e})=>[x("div",{class:"ml-30",innerHTML:e.conditions},null,8,se)])),_action:_((({_:l,record:s})=>[x("div",oe,[x("div",te,[v(je,null,{title:_((()=>[g("Actualizar elemento")])),default:_((()=>[x("div",{class:"i-heroicons:pencil-square w-1em h-1em text-blue-600 cursor-pointer",onClick:e=>(e=>{ce.value=e,ke()})(s)},null,8,ae)])),_:2},1024),v(Ce,{title:"Desea eliminar este elemento?","ok-text":"Si","cancel-text":"No",onConfirm:l=>(l=>{ve.value=!0;const{onResult:s,onError:o}=e.useDelete(l.id);s((()=>{c("success","Acción Exitosa","Se ha eliminado el elmento correctamente"),ve.value=!1,he()})),o((()=>{c("error","Acción Fallida","Ocurrio un error en la eliminación del elemento, puede estar asociado a otros elementos"),ve.value=!1}))})(s)},{icon:_((()=>[ie])),default:_((()=>[v(je,null,{title:_((()=>[g("Eliminar elemento")])),default:_((()=>[ne])),_:1})])),_:2},1032,["onConfirm"])])])])),_:1},8,["columns","data","loading_icon"])])])],64)}}});export{re as default};
