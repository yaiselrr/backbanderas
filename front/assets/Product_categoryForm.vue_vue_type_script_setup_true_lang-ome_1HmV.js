var e=Object.defineProperty,a=(a,t,r)=>((a,t,r)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r)(a,"symbol"!=typeof t?t+"":t,r);import{d as t,X as r,h as o,j as d,Y as i,k as s,r as l,a as n,S as c,n as u,z as m,q as p,v as g,O as _,E as y,Z as v,A as f,x as h,c as b,M as k,T as x,L as w,G as j,U as C}from"./index-D0wN_fuZ.js";import{_ as q}from"./RForm.vue_vue_type_script_setup_true_lang-HqTuq9xx.js";import{R,C as V}from"./RestBase-6hwWqa7t.js";import{r as P,i as M}from"./index-CFoXpmaN.js";import{d as E}from"./index-brT4NzTB.js";import{_ as S}from"./RButton.vue_vue_type_style_index_0_lang-DWca47Ax.js";import{_ as U}from"./RSelect.vue_vue_type_script_setup_true_lang-C-HhWqQ_.js";import{C as A}from"./categories.model-D6QCCUkg.js";import{P as F}from"./products.model-Dn3jzT27.js";const I=[{title:"Product",dataIndex:"product.name",align:"center",key:"product.name",customRender(e){var a;return null==(a=e.record.product)?void 0:a.name},sorter:(e,a)=>e.product&&a.product?(e.product.name>a.product.name)-(e.product.name<a.product.name):0},{title:"Category",dataIndex:"category.name",align:"center",key:"category.name",customRender(e){var a;return null==(a=e.record.category)?void 0:a.name},sorter:(e,a)=>e.category&&a.category?(e.category.name>a.category.name)-(e.category.name<a.category.name):0},{title:"Acciones",key:"_action",fixed:"right",scopedSlots:{customRender:"_action"}}],L={create:{product_id:{required:P,integer:M},category_id:{required:P,integer:M}},update:{product_id:{required:P,integer:M},category_id:{required:P,integer:M}}},z=await R("product_category","manage/product_category"),G=class extends z{constructor(e=null){super(),a(this,"id"),a(this,"product_id"),a(this,"category_id"),a(this,"created_at"),a(this,"updated_at"),null!=e&&(this.id=e.id||void 0,this.product_id=e.product_id||null,this.category_id=e.category_id||null,this.created_at=e.created_at?E(e.created_at):null,this.updated_at=e.updated_at?E(e.updated_at):null)}set_attributes(e=null){null!=e&&(this.id=e.id,this.product_id=e.product_id,this.category_id=e.category_id,this.created_at=E(e.created_at),this.updated_at=E(e.updated_at))}get_id(){return this.id}class_name(){return"Product_category"}};a(G,"validations",L),a(G,"feedbacks",{create:{id:{isUnique:"This id has been taken"}},update:{id:{isUnique:"This id has been taken"}}}),a(G,"columns",I),a(G,"visible_columns",G.show_columns(["*"],!0));let K=G;const N={class:"r-container-form"},O={class:"mt-10 sm:mt-0"},T={class:"shadow overflow-hidden sm:rounded-md"},B={class:"px-4 py-5 bg-white dark:bg-slate-800 sm:p-6"},X={class:"grid grid-cols-4 gap-4"},Y={class:"grid-input"},Z={class:"grid-input"},$={class:"px-4 py-3 bg-gray-50 dark:bg-slate-700 dark:bg-opacity-70 text-right sm:px-6"},D={class:"r-footer-form"},H={class:"flex"},J={key:0,class:"flex-none items-center"},Q=[h("label",{for:"andNew",class:"font-bold text-gray-700 dark:text-slate-200 !cursor-pointer"},[w("Insertar y nuevo "),h("span",{id:"andNew-description",class:"ml-1 text-muted"},"Se insertara un elemento y reiniciara el formuario")],-1)],W={class:"r-footer-button-form"},ee=t({__name:"Product_categoryForm",props:r({modal:o.bool.def(!1),action:o.string.def("create"),loading_text:o.string.def(""),showLoading:o.bool.def(!0)},{modelValue:{},modelModifiers:{}}),emits:r(["closeModal","reload"],["update:modelValue"]),setup(e,{emit:a}){const t=d(),r=e,o=a,R="create"==r.action?"Crear":"Actualizar",P=i(e,"modelValue"),M=s(new K(P.value)),E=l(),I=l(!1),{loading:L,result:z}=A.useGetMany(),{loading:G,result:ee}=F.useGetMany(),{loading:ae,toggleEnabled:te,onResult:re,enabled:oe,onError:de}=K.useStaticSave(M,{defaultEnabled:!1}),ie=n((()=>L.value||G.value)),se=()=>{r.modal?o("closeModal"):t.push({name:"product_category_list"})};async function le(){var e;await(null==(e=E.value)?void 0:e.validate())&&te()}return de((e=>{c("error","Error en accion","Error en accion del elemento")})),re((e=>{var a;c("success","Accion  "+R,"Accion ejecutada correctamente"),I.value?(null==(a=E.value)||a.clear(),oe.value=!1,Object.assign(M,new K(P.value)),r.modal&&o("reload")):r.modal?o("closeModal",!0):t.push({name:"product_category_list"})})),(a,t)=>{const o=V;return u(),m(C,null,[e.showLoading?(u(),p(v,{key:0,"h-full":!0,class:"",loading:y(ie),description:r.loading_text},{default:g((()=>[_(a.$slots,"loading_icon")])),_:3},8,["loading","description"])):f("",!0),h("div",N,[h("div",O,[h("div",T,[b(q,{ref_key:"product_categoryForm",ref:E,state:y(M),validations:y(K).validations[e.action],feedbacks:y(K).feedbacks[e.action],loading:!0},{default:g((()=>{var a,r;return[h("div",B,[h("div",X,[h("div",Y,[b(U,{modelValue:y(M).product_id,"onUpdate:modelValue":t[0]||(t[0]=e=>y(M).product_id=e),"id-key":"id","required-mark":!0,ref:"selectId","loading-data":y(G),loading:y(G),"text-key":"name",allowClear:!0,showFilter:"",items:null==(a=y(ee))?void 0:a.data,label:"Products",onKeyup:k(le,["enter"])},null,8,["modelValue","loading-data","loading","items"])]),h("div",Z,[b(U,{modelValue:y(M).category_id,"onUpdate:modelValue":t[1]||(t[1]=e=>y(M).category_id=e),"id-key":"id","required-mark":!0,ref:"selectId","loading-data":y(L),loading:y(L),"text-key":"description",allowClear:!0,showFilter:"",items:null==(r=y(z))?void 0:r.data,label:"Categories",onKeyup:k(le,["enter"])},null,8,["modelValue","loading-data","loading","items"])])])]),h("div",$,[h("div",D,[h("div",H,["create"===e.action?(u(),m("div",J,[b(o,{checked:y(I),"onUpdate:checked":t[2]||(t[2]=e=>x(I)?I.value=e:null),"aria-describedby":"offers-description",id:"andNew"},null,8,["checked"])])):f("",!0),"create"===e.action?(u(),m("div",{key:1,onClick:t[3]||(t[3]=e=>y(I).value!=y(I).value),class:"flex text-sm absolute mx-[2rem] my-[4px]"},Q)):f("",!0)]),h("div",W,[b(S,{class:"ml-5",shadow:"",color:"primary",loading:y(ae),onClick:le},{default:g((()=>[w(j(y(R))+" Product_category ",1)])),_:1},8,["loading"]),b(S,{class:"ml-5",shadow:"",color:"primary",onClick:se},{default:g((()=>[w(" Cancelar ")])),_:1})])])])]})),_:1},8,["state","validations","feedbacks"])])])])],64)}}});export{K as P,ee as _};
