import{M as e,_ as l}from"./Message_blocksForm.vue_vue_type_script_setup_true_lang-NC6w5Zui.js";import{_ as s,a as o,b as a,c as t}from"./ConfirmModal.vue_vue_type_script_setup_true_lang-CMNdRJV8.js";import{d as i,r as n,a as r,Q as c,k as d,S as u,n as m,z as p,c as _,v,x,y as f,E as j,G as h,T as g,L as y,R as w,U as b,V as k,W as C,H as E}from"./index-D0wN_fuZ.js";import{_ as R}from"./RAvatar.vue_vue_type_script_setup_true_lang-BKX40U8Z.js";import{M}from"./index-BZUQu6cJ.js";import{_ as B,B as A}from"./index-DK-IiT8x.js";import{I as L}from"./index-_uS1yxUQ.js";import{_ as S,M as q}from"./index-BQa5vSjM.js";import{_ as D,a as V}from"./dropdown-DdxiuV_U.js";import"./RForm.vue_vue_type_script_setup_true_lang-HqTuq9xx.js";import"./index-BtQlog3F.js";import"./RestBase-6hwWqa7t.js";import"./createContext-Cl9SgfpP.js";import"./FormItemContext-CfbnWjAK.js";import"./index-CFoXpmaN.js";import"./debounceValidator-Cl5zTG4a.js";import"./index-brT4NzTB.js";import"./RButton.vue_vue_type_style_index_0_lang-DWca47Ax.js";import"./REditor.vue_vue_type_style_index_0_lang-B9q55COs.js";import"./useValidation-Dimmn3XB.js";import"./index-DEby8QZG.js";import"./debounce-Cg7NfA5c.js";import"./colors-Bmc914HC.js";import"./supportsPassive-pertglWR.js";import"./index-C2qDfXmS.js";import"./useRefs-CLREAGAq.js";import"./EyeOutlined-DOQragHS.js";import"./styleChecker-CGBUfLOL.js";import"./collapseMotion-BM3-mHdV.js";import"./useMergedState-BcJwUeRJ.js";import"./KeyCode-BFt-2P2l.js";import"./index-BstQ-YzR.js";import"./index-DtiMcqIf.js";import"./LeftOutlined-BPCL5cU7.js";import"./isMobile-VPrdNIIw.js";import"./useMemo-CnyBa7eu.js";import"./DownOutlined-DYgTl6g-.js";import"./index-ChnaMK_j.js";import"./index-D-OtIBMI.js";import"./types-DSoMB_y9.js";import"./shallowequal-UQLE3OsX.js";const O=x("div",{class:"r-close-icon hoverable-close"},null,-1),F={class:"flex"},I=x("div",{class:"r-loading-default"},null,-1),z={class:"r-breadcumbs"},K=x("div",{class:"flex justify-center items-center"},[x("div",{class:"i-heroicons:home w-1em h-1em mr-1"}),x("p",null,"Inicio")],-1),T=x("div",null,[x("h1",{class:"mt-5"},"Bloques de mensajes")],-1),U={class:"r-container-list"},H={class:"relative card w-full float-right"},P={class:""},G={class:"components-input-demo-presuffix mt-3 flex"},X=x("span",{class:"i-heroicons:trash-16-solid text-md mr-1 mb-1"},null,-1),Y=x("span",{class:"i-heroicons:plus-16-solid text-lg mr-1 mb-1"},null,-1),Z={class:"w-50% mr-20"},N={class:"float-right align-middle"},Q={class:"justify-start w-20%"},W=x("div",{class:"i-mdi:search w-1em h-1em text-2xl"},null,-1),$={class:"flex justify-end w-20%"},J=x("div",{class:"flex"},[x("div",{class:"i-mdi:export-variant w-1em h-1em text-xl mr-1"}),y(" Exportar ")],-1),ee=x("span",{class:"flex"},[x("div",{class:"i-mdi:file-csv-outline w-1em h-1em text-gray-900 mr-2 text-xl"}),y(" CSV ")],-1),le=x("span",{class:"flex"},[x("div",{class:"i-mdi:microsoft-excel w-1em h-1em text-green-700 mr-2 text-xl"}),y(" EXCEL ")],-1),se=x("span",{class:"flex"},[x("div",{class:"i-mdi:file-pdf-box w-1em h-1em text-red-500 mr-2 text-xl"}),y(" PDF ")],-1),oe=["innerHTML"],ae={class:"flex justify-center align-center"},te={class:"text-xl flex justify-center align-center"},ie=["onClick"],ne=x("div",{class:"i-heroicons:trash w-1em h-1em text-red-600 cursor-pointer mt-1"},null,-1),re=x("div",{class:"i-heroicons:trash w-1em h-1em text-red-600 cursor-pointer"},null,-1),ce=i({__name:"Message_blocksList",setup(i){const ce=n(),de=n([]),ue=n(null),me=n(null),pe=e.visible_columns,_e=r((()=>de.value.filter((e=>c(e,ce.value,pe))))),{loading:ve,result:xe,onError:fe,onResult:je,refetch:he}=e.useGetMany({relations:"all"}),ge=d([]),{onError:ye,onResult:we,toggleEnabled:be,loading:ke,enabled:Ce}=e.useDeleteById(ge,{defaultEnabled:!1});je((e=>{de.value=e.data.data})),fe((e=>{u("error","Error de peticion","Error de peticion del elemento")}));const Ee=n(!1),Re=(e=!1)=>{Ee.value=!Ee.value,e&&(M.destroyAll(),he())},Me=()=>{me.value=null,Re()},Be=(e=!1)=>{me.value=null,Re(e)};we((()=>{var e;he(),null==(e=null==ue?void 0:ue.value)||e.clearSelection(),u("success","Acción Exitosa","Se han eliminado los elementos correctamente"),Ce.value=!1,M.destroyAll()}));const Ae=()=>{M.confirm({title:_(a,{text:"¿Desea eliminar el/los elementos seleccionados?",iconClass:"i-heroicons:trash w-1em h-1em text-4xl color-red-500",textClass:"ml-5 text-xl",loading:ke,onOk:()=>{var e;Object.assign(ge,null==(e=null==ue?void 0:ue.value)?void 0:e.selectedRowKeys),be()}}),icon:null,footer:null})},Le=()=>{k("Message_blocksList",pe,_e.value)},Se=()=>{C("Message_blocksList",pe,_e.value)};return(a,i)=>{var n,r;const c=M,d=E("router-link"),k=B,C=A,de=L,xe=S,fe=q,je=D,ge=V,ye=t;return m(),p(b,null,[_(c,{open:j(Ee),"onUpdate:open":i[1]||(i[1]=e=>g(Ee)?Ee.value=e:null),footer:null,"destroy-on-close":!0,onCancel:i[2]||(i[2]=e=>me.value=null),"wrap-class-name":"modal-form",width:"55%"},{closeIcon:v((()=>[O])),title:v((()=>[x("div",F,[x("div",{class:f([j(me)?"i-heroicons:pencil-square":"i-heroicons:plus-20-solid","w-1em h-1em p-3.5 mr-2"])},null,2),x("h1",null,h(j(me)?"Actualizar Blocks":"Crear Blocks"),1)])])),default:v((()=>[_(l,{modal:!0,modelValue:j(me),"onUpdate:modelValue":i[0]||(i[0]=e=>g(me)?me.value=e:null),action:j(me)?"update":"create",onCloseModal:Be,onReload:j(he),"show-loading":!0},{loading_icon:v((()=>[I])),_:1},8,["modelValue","action","onReload"])])),_:1},8,["open"]),x("div",z,[_(C,{class:"h-full"},{default:v((()=>[_(k,null,{default:v((()=>[_(d,{to:{name:"index"}},{default:v((()=>[K])),_:1})])),_:1}),_(k,null,{default:v((()=>[y("Configuraciones")])),_:1}),_(k,null,{default:v((()=>[y("Bloques de mensajes")])),_:1})])),_:1}),T]),x("div",U,[x("div",H,[x("div",P,[x("div",G,[_(j(w),{shadow:"",ref:"btnDelete",class:"btn-delete",disabled:0===(null==(n=j(ue))?void 0:n.selectedRowKeys.length),onClick:Ae},{default:v((()=>[X,y(" Eliminar ")])),_:1},8,["disabled"]),_(j(w),{class:"mr-3",shadow:"",onClick:Me},{default:v((()=>[Y,y(" Crear Bloques de mensajes ")])),_:1}),x("div",Z,[x("span",N,"Elementos seleccionados "+h(null==(r=j(ue))?void 0:r.selectedRowKeys.length)+"/"+h(j(_e).length),1)]),x("div",Q,[_(de,{value:j(ce),"onUpdate:value":i[3]||(i[3]=e=>g(ce)?ce.value=e:null),class:"col-1",placeholder:"Buscar elemento","allow-clear":!0},{prefix:v((()=>[W])),_:1},8,["value"])]),x("div",$,[_(je,{class:"flex"},{overlay:v((()=>[_(fe,null,{default:v((()=>[_(xe,{key:"1",onClick:Le},{default:v((()=>[ee])),_:1}),_(xe,{key:"2",onClick:Se},{default:v((()=>[le])),_:1}),_(xe,{key:"3"},{default:v((()=>[se])),_:1})])),_:1})])),default:v((()=>[J])),_:1})])])]),_(o,{ref_key:"message_blocksTbl",ref:ue,columns:j(pe),data:j(_e),loading_icon:j(ve),has_selection:!0,on_select:e=>{},onChangePagination:i[4]||(i[4]=e=>{j(he)()}),id_element:"id",expanded:!0,class:"mt-5"},{loading_icon:v((()=>[_(s)])),expandedRowRender:v((({record:e})=>[x("div",{class:"ml-30",innerHTML:e.message_text},null,8,oe)])),block_image:v((({_:e,record:l})=>[_(R,{img:l.block_image,size:33,circle:!0},null,8,["img"])])),_action:v((({_:l,record:s})=>[x("div",ae,[x("div",te,[_(ge,null,{title:v((()=>[y("Actualizar elemento")])),default:v((()=>[x("div",{class:"i-heroicons:pencil-square w-1em h-1em text-blue-600 cursor-pointer",onClick:e=>(e=>{me.value=e,Re()})(s)},null,8,ie)])),_:2},1024),_(ye,{title:"Desea eliminar este elemento?","ok-text":"Si","cancel-text":"No",onConfirm:l=>(l=>{ve.value=!0;const{onResult:s,onError:o}=e.useDelete(l.id);s((()=>{u("success","Acción Exitosa","Se ha eliminado el elmento correctamente"),ve.value=!1,he()})),o((()=>{u("error","Acción Fallida","Ocurrio un error en la eliminación del elemento, puede estar asociado a otros elementos"),ve.value=!1}))})(s)},{icon:v((()=>[ne])),default:v((()=>[_(ge,null,{title:v((()=>[y("Eliminar elemento")])),default:v((()=>[re])),_:1})])),_:2},1032,["onConfirm"])])])])),_:1},8,["columns","data","loading_icon"])])])],64)}}});export{ce as default};
