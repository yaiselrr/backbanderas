var e=Object.defineProperty,t=(t,a,d)=>((t,a,d)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:d}):t[a]=d)(t,"symbol"!=typeof a?a+"":a,d);import{d as a,X as d,h as r,j as o,Y as i,k as s,r as n,a as l,S as c,n as u,z as p,q as m,v as _,O as h,E as f,Z as v,A as g,x as b,c as y,M as k,T as x,L as q,G as w,U as V}from"./index-D0wN_fuZ.js";import{_ as j}from"./RForm.vue_vue_type_script_setup_true_lang-HqTuq9xx.js";import{R,C as U}from"./RestBase-6hwWqa7t.js";import{r as M,i as C,m as A,R as E}from"./index-CFoXpmaN.js";import{d as I}from"./debounceValidator-Cl5zTG4a.js";import{d as S}from"./index-brT4NzTB.js";import{_ as L}from"./RButton.vue_vue_type_style_index_0_lang-DWca47Ax.js";import{_ as T}from"./RSelect.vue_vue_type_script_setup_true_lang-C-HhWqQ_.js";import{_ as F}from"./REditor.vue_vue_type_style_index_0_lang-B9q55COs.js";import{P as N}from"./product_order.model-CkNpk3IZ.js";const O=[{title:"Code",dataIndex:"code",align:"center",key:"code",sorter:(e,t)=>+(e.code>t.code)-+(e.code<t.code)},{title:"Product_order",dataIndex:"product_order.id",align:"center",key:"product_order.id",customRender(e){var t;return null==(t=e.record.product_order)?void 0:t.id},sorter:(e,t)=>e.product_order&&t.product_order?e.product_order.id-t.product_order.id:0},{title:"Amount",dataIndex:"amount",align:"center",key:"amount",sorter:(e,t)=>e.amount-t.amount},{title:"Description",dataIndex:"description",align:"center",key:"description",sorter:(e,t)=>+(e.description>t.description)-+(e.description<t.description)},{title:"Acciones",key:"_action",fixed:"right",scopedSlots:{customRender:"_action"}}],z={create:{code:{required:M,isUnique:I((function(e,t){const{id:a,code:d}={...t.state},r=a?"update":"create";return!d||B.validate({code:d,id:a,_scenario:r,_specific:!0})}),void 0,500)},product_order_id:{required:M,integer:C},amount:{required:M,integer:C},description:{required:M,maxLength:A(65535)}},update:{code:{required:M,isUnique:I((function(e,t){const{id:a,code:d}={...t.state},r=a?"update":"create";return!d||B.validate({code:d,id:a,_scenario:r,_specific:!0})}),void 0,500)},product_order_id:{required:M,integer:C},amount:{required:M,integer:C},description:{required:M,maxLength:A(65535)}}},K=await R("refurbished","manage/refurbished"),P=class extends K{constructor(e=null){super(),t(this,"id"),t(this,"code"),t(this,"product_order_id"),t(this,"amount"),t(this,"description"),t(this,"created_at"),t(this,"updated_at"),null!=e&&(this.id=e.id||void 0,this.code=e.code||null,this.product_order_id=e.product_order_id||null,this.amount=e.amount||null,this.description=e.description||null,this.created_at=e.created_at?S(e.created_at):null,this.updated_at=e.updated_at?S(e.updated_at):null)}set_attributes(e=null){null!=e&&(this.id=e.id,this.code=e.code,this.product_order_id=e.product_order_id,this.amount=e.amount,this.description=e.description,this.created_at=S(e.created_at),this.updated_at=S(e.updated_at))}get_id(){return this.id}class_name(){return"Refurbished"}};t(P,"validations",z),t(P,"feedbacks",{create:{code:{isUnique:"This code has been taken"},id:{isUnique:"This id has been taken"}},update:{code:{isUnique:"This code has been taken"},id:{isUnique:"This id has been taken"}}}),t(P,"columns",O),t(P,"visible_columns",P.show_columns(["*"],!0));let B=P;const D={class:"r-container-form"},G={class:"mt-10 sm:mt-0"},X={class:"shadow overflow-hidden sm:rounded-md"},Y={class:"px-4 py-5 bg-white dark:bg-slate-800 sm:p-6"},Z={class:"grid grid-cols-4 gap-4"},$={class:"grid-input"},H={class:"grid-input"},J={class:"grid-input"},Q={class:"col-span-4"},W={class:"px-4 py-3 bg-gray-50 dark:bg-slate-700 dark:bg-opacity-70 text-right sm:px-6"},ee={class:"r-footer-form"},te={class:"flex"},ae={key:0,class:"flex-none items-center"},de=[b("label",{for:"andNew",class:"font-bold text-gray-700 dark:text-slate-200 !cursor-pointer"},[q("Insertar y nuevo "),b("span",{id:"andNew-description",class:"ml-1 text-muted"},"Se insertara un elemento y reiniciara el formuario")],-1)],re={class:"r-footer-button-form"},oe=a({__name:"RefurbishedForm",props:d({modal:r.bool.def(!1),action:r.string.def("create"),loading_text:r.string.def(""),showLoading:r.bool.def(!0)},{modelValue:{},modelModifiers:{}}),emits:d(["closeModal","reload"],["update:modelValue"]),setup(e,{emit:t}){const a=o(),d=e,r=t,R="create"==d.action?"Crear":"Actualizar",M=i(e,"modelValue"),C=s(new B(M.value)),A=n(),I=n(!1),{loading:S,result:O}=N.useGetMany(),{loading:z,toggleEnabled:K,onResult:P,enabled:oe,onError:ie}=B.useStaticSave(C,{defaultEnabled:!1}),se=l((()=>S.value)),ne=()=>{d.modal?r("closeModal"):a.push({name:"refurbished_list"})};async function le(){var e;await(null==(e=A.value)?void 0:e.validate())&&K()}return ie((e=>{c("error","Error en accion","Error en accion del elemento")})),P((e=>{var t;c("success","Accion  "+R,"Accion ejecutada correctamente"),I.value?(null==(t=A.value)||t.clear(),oe.value=!1,Object.assign(C,new B(M.value)),d.modal&&r("reload")):d.modal?r("closeModal",!0):a.push({name:"refurbished_list"})})),(t,a)=>{const r=U;return u(),p(V,null,[e.showLoading?(u(),m(v,{key:0,"h-full":!0,class:"",loading:f(se),description:d.loading_text},{default:_((()=>[h(t.$slots,"loading_icon")])),_:3},8,["loading","description"])):g("",!0),b("div",D,[b("div",G,[b("div",X,[y(j,{ref_key:"refurbishedForm",ref:A,state:f(C),validations:f(B).validations[e.action],feedbacks:f(B).feedbacks[e.action],loading:!0},{default:_((()=>{var t;return[b("div",Y,[b("div",Z,[b("div",$,[y(f(E),{type:"text",requiredMark:!0,modelValue:f(C).code,"onUpdate:modelValue":a[0]||(a[0]=e=>f(C).code=e),path:"code",label:"Code",onKeyup:k(le,["enter"])},null,8,["modelValue"])]),b("div",H,[y(T,{modelValue:f(C).product_order_id,"onUpdate:modelValue":a[1]||(a[1]=e=>f(C).product_order_id=e),"id-key":"id","required-mark":!0,ref:"selectId","loading-data":f(S),loading:f(S),"text-key":"quantity",allowClear:!0,showFilter:"",items:null==(t=f(O))?void 0:t.data,label:"Orden de producto",onKeyup:k(le,["enter"])},null,8,["modelValue","loading-data","loading","items"])]),b("div",J,[y(f(E),{onlyNumbers:!0,type:"number",requiredMark:!0,modelValue:f(C).amount,"onUpdate:modelValue":a[2]||(a[2]=e=>f(C).amount=e),path:"amount",label:"Amount",onKeyup:k(le,["enter"])},null,8,["modelValue"])]),b("div",Q,[y(F,{requiredMark:!0,modelValue:f(C).description,"onUpdate:modelValue":a[3]||(a[3]=e=>f(C).description=e),path:"description",label:"Description"},null,8,["modelValue"])])])]),b("div",W,[b("div",ee,[b("div",te,["create"===e.action?(u(),p("div",ae,[y(r,{checked:f(I),"onUpdate:checked":a[4]||(a[4]=e=>x(I)?I.value=e:null),"aria-describedby":"offers-description",id:"andNew"},null,8,["checked"])])):g("",!0),"create"===e.action?(u(),p("div",{key:1,onClick:a[5]||(a[5]=e=>f(I).value!=f(I).value),class:"flex text-sm absolute mx-[2rem] my-[4px]"},de)):g("",!0)]),b("div",re,[y(L,{class:"ml-5",shadow:"",color:"primary",loading:f(z),onClick:le},{default:_((()=>[q(w(f(R))+" Refurbished ",1)])),_:1},8,["loading"]),y(L,{class:"ml-5",shadow:"",color:"primary",onClick:ne},{default:_((()=>[q(" Cancelar ")])),_:1})])])])]})),_:1},8,["state","validations","feedbacks"])])])])],64)}}});export{B as R,oe as _};
