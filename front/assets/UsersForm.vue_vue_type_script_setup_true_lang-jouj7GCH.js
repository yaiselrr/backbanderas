import{d as e,X as a,h as l,j as s,Y as o,k as r,r as d,a as t,S as i,n,z as u,q as c,v as m,O as p,E as v,Z as _,A as f,x as g,c as y,M as b,T as k,L as h,G as V,U as w}from"./index-D0wN_fuZ.js";import{_ as x}from"./RForm.vue_vue_type_script_setup_true_lang-HqTuq9xx.js";import{U as j}from"./users.model-13Myq0P6.js";import{_ as C}from"./RButton.vue_vue_type_style_index_0_lang-DWca47Ax.js";import{R as U}from"./index-CFoXpmaN.js";import{_ as M}from"./RSelect.vue_vue_type_script_setup_true_lang-C-HhWqQ_.js";import{_ as R}from"./REditor.vue_vue_type_style_index_0_lang-B9q55COs.js";import{R as q}from"./roles.model-CLThzeQD.js";import{C as E}from"./RestBase-6hwWqa7t.js";const K={class:"r-container-form"},S={class:"mt-10 sm:mt-0"},A={class:"shadow overflow-hidden sm:rounded-md"},F={class:"px-4 py-5 bg-white dark:bg-slate-800 sm:p-6"},N={class:"grid grid-cols-2 gap-4"},z={class:"grid-input"},L={class:"grid-input"},B={key:0,class:"grid-input"},G={key:1,class:"grid-input"},I={class:"grid-input"},O={class:"grid-input"},T={class:"col-span-2"},D={class:"px-4 py-3 bg-gray-50 dark:bg-slate-700 dark:bg-opacity-70 text-right sm:px-6"},X={class:"r-footer-form"},Y={class:"flex"},Z={key:0,class:"flex-none items-center"},$=[g("label",{for:"andNew",class:"font-bold text-gray-700 dark:text-slate-200 !cursor-pointer"},[h("Insertar y nuevo "),g("span",{id:"andNew-description",class:"ml-1 text-muted"},"Se insertará un elemento y reiniciará el formulario")],-1)],H={class:"r-footer-button-form"},J=e({__name:"UsersForm",props:a({modal:l.bool.def(!1),action:l.string.def("create"),loading_text:l.string.def(""),showLoading:l.bool.def(!0)},{modelValue:{},modelModifiers:{}}),emits:a(["closeModal","reload"],["update:modelValue"]),setup(e,{emit:a}){const l=s(),J=e,P=a,Q="create"==J.action?"Crear":"Actualizar",W=o(e,"modelValue"),ee=r(new j(W.value)),ae=d(),le=d(!1),{loading:se,result:oe}=q.useGetMany(),{loading:re,toggleEnabled:de,onResult:te,enabled:ie,onError:ne}=j.useStaticSave(ee,{defaultEnabled:!1}),ue=t((()=>se.value)),ce=()=>{J.modal?P("closeModal"):l.push({name:"users_list"})};async function me(){var e;await(null==(e=ae.value)?void 0:e.validate())&&de()}return ne((e=>{i("error","Error en acción","Error en acción del elemento")})),te((e=>{var a;i("success","Accion  "+Q,"Accion ejecutada correctamente"),le.value?(null==(a=ae.value)||a.clear(),ie.value=!1,Object.assign(ee,new j(W.value)),J.modal&&P("reload")):J.modal?P("closeModal",!0):l.push({name:"users_list"})})),(a,l)=>{const s=E;return n(),u(w,null,[e.showLoading?(n(),c(_,{key:0,"h-full":!0,class:"",loading:v(ue),description:J.loading_text},{default:m((()=>[p(a.$slots,"loading_icon")])),_:3},8,["loading","description"])):f("",!0),g("div",K,[g("div",S,[g("div",A,[y(x,{ref_key:"usersForm",ref:ae,state:v(ee),validations:v(j).validations[e.action],feedbacks:v(j).feedbacks[e.action],loading:!0},{default:m((()=>{var a;return[g("div",F,[g("div",N,[g("div",z,[y(v(U),{type:"text",requiredMark:!0,modelValue:v(ee).name,"onUpdate:modelValue":l[0]||(l[0]=e=>v(ee).name=e),path:"name",label:"Nombre",onKeyup:b(me,["enter"])},null,8,["modelValue"])]),g("div",L,[y(v(U),{type:"email",requiredMark:!0,modelValue:v(ee).email,"onUpdate:modelValue":l[1]||(l[1]=e=>v(ee).email=e),path:"email",label:"Correo",onKeyup:b(me,["enter"])},null,8,["modelValue"])]),"create"===e.action?(n(),u("div",B,[y(v(U),{type:"password",requiredMark:!0,modelValue:v(ee).password,"onUpdate:modelValue":l[2]||(l[2]=e=>v(ee).password=e),path:"password",label:"Contraseña",onKeyup:b(me,["enter"])},null,8,["modelValue"])])):f("",!0),"create"===e.action?(n(),u("div",G,[y(v(U),{type:"password",requiredMark:!0,modelValue:v(ee).confirm_password,"onUpdate:modelValue":l[3]||(l[3]=e=>v(ee).confirm_password=e),path:"confirm_password",label:"Confirmar Contraseña",onKeyup:b(me,["enter"])},null,8,["modelValue"])])):f("",!0),g("div",I,[y(M,{modelValue:v(ee).role_id,"onUpdate:modelValue":l[4]||(l[4]=e=>v(ee).role_id=e),"id-key":"id","required-mark":!0,ref:"selectId","loading-data":v(se),loading:v(se),"text-key":"name",allowClear:!0,showFilter:"",items:null==(a=v(oe))?void 0:a.data,path:"role_id",label:"Rol",onKeyup:b(me,["enter"])},null,8,["modelValue","loading-data","loading","items"])]),g("div",O,[y(v(U),{requiredMark:!0,modelValue:v(ee).phones,"onUpdate:modelValue":l[5]||(l[5]=e=>v(ee).phones=e),path:"phones",label:"Telefono",onKeyup:b(me,["enter"])},null,8,["modelValue"])]),g("div",T,[y(R,{modelValue:v(ee).addresses,"onUpdate:modelValue":l[6]||(l[6]=e=>v(ee).addresses=e),path:"addresses",label:"Dirección"},null,8,["modelValue"])])])]),g("div",D,[g("div",X,[g("div",Y,["create"===e.action?(n(),u("div",Z,[y(s,{checked:v(le),"onUpdate:checked":l[7]||(l[7]=e=>k(le)?le.value=e:null),"aria-describedby":"offers-description",id:"andNew"},null,8,["checked"])])):f("",!0),"create"===e.action?(n(),u("div",{key:1,onClick:l[8]||(l[8]=e=>v(le).value!=v(le).value),class:"flex text-sm absolute mx-[2rem] my-[4px]"},$)):f("",!0)]),g("div",H,[y(C,{class:"ml-5",shadow:"",color:"primary",loading:v(re),onClick:me},{default:m((()=>[h(V(v(Q))+" Usuarios ",1)])),_:1},8,["loading"]),y(C,{class:"ml-5",shadow:"",color:"primary",onClick:ce},{default:m((()=>[h(" Cancelar ")])),_:1})])])])]})),_:1},8,["state","validations","feedbacks"])])])])],64)}}});export{J as _};
