var e=Object.defineProperty,a=(a,s,t)=>((a,s,t)=>s in a?e(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t)(a,"symbol"!=typeof s?s+"":s,t);import{d as s,X as t,h as d,j as i,Y as l,k as r,r as o,a as n,S as c,n as u,z as m,q as _,v as p,O as v,E as g,Z as f,A as h,x as b,c as y,M as k,T as x,L as w,G as C,U as j}from"./index-D0wN_fuZ.js";import{_ as q}from"./RForm.vue_vue_type_script_setup_true_lang-HqTuq9xx.js";import{R as U,C as R}from"./RestBase-6hwWqa7t.js";import{r as V,i as M,R as E}from"./index-CFoXpmaN.js";import{d as S}from"./index-brT4NzTB.js";import{_ as A}from"./RButton.vue_vue_type_style_index_0_lang-DWca47Ax.js";import{_ as T}from"./RSelect.vue_vue_type_script_setup_true_lang-C-HhWqQ_.js";import{U as F}from"./users.model-13Myq0P6.js";const I=[{title:"Code",dataIndex:"code",align:"center",key:"code",sorter:(e,a)=>+(e.code>a.code)-+(e.code<a.code)},{title:"Users",dataIndex:"users.name",align:"center",key:"users.name",customRender(e){var a;return null==(a=e.record.users)?void 0:a.name},sorter:(e,a)=>e.users&&a.users?(e.users.name>a.users.name)-(e.users.name<a.users.name):0},{title:"Acciones",key:"_action",fixed:"right",scopedSlots:{customRender:"_action"}}],z={create:{code:{required:V},user_id:{required:V,integer:M}},update:{code:{required:V},user_id:{required:V,integer:M}}},L=await U("client","manage/client"),N=class extends L{constructor(e=null){super(),a(this,"code"),a(this,"user_id"),a(this,"created_at"),a(this,"updated_at"),null!=e&&(this.code=e.code||void 0,this.user_id=e.user_id||null,this.created_at=e.created_at?S(e.created_at):null,this.updated_at=e.updated_at?S(e.updated_at):null)}set_attributes(e=null){null!=e&&(this.code=e.code,this.user_id=e.user_id,this.created_at=S(e.created_at),this.updated_at=S(e.updated_at))}get_id(){return this.code}class_name(){return"Client"}};a(N,"validations",z),a(N,"feedbacks",{create:{code:{isUnique:"This code has been taken"},id:{isUnique:"This id has been taken"}},update:{code:{isUnique:"This code has been taken"},id:{isUnique:"This id has been taken"}}}),a(N,"columns",I),a(N,"visible_columns",N.show_columns(["*"],!0));let O=N;const B={class:"r-container-form"},G={class:"mt-10 sm:mt-0"},K={class:"shadow overflow-hidden sm:rounded-md"},P={class:"px-4 py-5 bg-white dark:bg-slate-800 sm:p-6"},X={class:"grid grid-cols-4 gap-4"},Y={class:"grid-input"},Z={class:"grid-input"},$={class:"px-4 py-3 bg-gray-50 dark:bg-slate-700 dark:bg-opacity-70 text-right sm:px-6"},D={class:"r-footer-form"},H={class:"flex"},J={key:0,class:"flex-none items-center"},Q=[b("label",{for:"andNew",class:"font-bold text-gray-700 dark:text-slate-200 !cursor-pointer"},[w("Insertar y nuevo "),b("span",{id:"andNew-description",class:"ml-1 text-muted"},"Se insertara un elemento y reiniciara el formuario")],-1)],W={class:"r-footer-button-form"},ee=s({__name:"ClientForm",props:t({modal:d.bool.def(!1),action:d.string.def("create"),loading_text:d.string.def(""),showLoading:d.bool.def(!0)},{modelValue:{},modelModifiers:{}}),emits:t(["closeModal","reload"],["update:modelValue"]),setup(e,{emit:a}){const s=i(),t=e,d=a,U="create"==t.action?"Crear":"Actualizar",V=l(e,"modelValue"),M=r(new O(V.value)),S=o(),I=o(!1),{loading:z,result:L}=F.useGetMany(),{loading:N,toggleEnabled:ee,onResult:ae,enabled:se,onError:te}=O.useStaticSave(M,{defaultEnabled:!1}),de=n((()=>z.value)),ie=()=>{t.modal?d("closeModal"):s.push({name:"client_list"})};async function le(){var e;await(null==(e=S.value)?void 0:e.validate())&&ee()}return te((e=>{c("error","Error en accion","Error en accion del elemento")})),ae((e=>{var a;c("success","Accion  "+U,"Accion ejecutada correctamente"),I.value?(null==(a=S.value)||a.clear(),se.value=!1,Object.assign(M,new O(V.value)),t.modal&&d("reload")):t.modal?d("closeModal",!0):s.push({name:"client_list"})})),(a,s)=>{const d=R;return u(),m(j,null,[e.showLoading?(u(),_(f,{key:0,"h-full":!0,class:"",loading:g(de),description:t.loading_text},{default:p((()=>[v(a.$slots,"loading_icon")])),_:3},8,["loading","description"])):h("",!0),b("div",B,[b("div",G,[b("div",K,[y(q,{ref_key:"clientForm",ref:S,state:g(M),validations:g(O).validations[e.action],feedbacks:g(O).feedbacks[e.action],loading:!0},{default:p((()=>{var a;return[b("div",P,[b("div",X,[b("div",Y,[y(g(E),{type:"text",requiredMark:!0,modelValue:g(M).code,"onUpdate:modelValue":s[0]||(s[0]=e=>g(M).code=e),path:"code",label:"CÃ³digo",onKeyup:k(le,["enter"])},null,8,["modelValue"])]),b("div",Z,[y(T,{modelValue:g(M).user_id,"onUpdate:modelValue":s[1]||(s[1]=e=>g(M).user_id=e),"id-key":"id","required-mark":!0,ref:"selectId","loading-data":g(z),loading:g(z),"text-key":"name",allowClear:!0,showFilter:"",items:null==(a=g(L))?void 0:a.data,path:"user_id",label:"Usuario",onKeyup:k(le,["enter"])},null,8,["modelValue","loading-data","loading","items"])])])]),b("div",$,[b("div",D,[b("div",H,["create"===e.action?(u(),m("div",J,[y(d,{checked:g(I),"onUpdate:checked":s[2]||(s[2]=e=>x(I)?I.value=e:null),"aria-describedby":"offers-description",id:"andNew"},null,8,["checked"])])):h("",!0),"create"===e.action?(u(),m("div",{key:1,onClick:s[3]||(s[3]=e=>g(I).value!=g(I).value),class:"flex text-sm absolute mx-[2rem] my-[4px]"},Q)):h("",!0)]),b("div",W,[y(A,{class:"ml-5",shadow:"",color:"primary",loading:g(N),onClick:le},{default:p((()=>[w(C(g(U))+" Cliente ",1)])),_:1},8,["loading"]),y(A,{class:"ml-5",shadow:"",color:"primary",onClick:ie},{default:p((()=>[w(" Cancelar ")])),_:1})])])])]})),_:1},8,["state","validations","feedbacks"])])])])],64)}}});export{O as C,ee as _};
