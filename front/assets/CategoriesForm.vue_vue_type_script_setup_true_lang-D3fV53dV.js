import{d as e,X as a,h as l,j as s,Y as t,k as o,r as i,a as r,S as d,n,z as c,q as u,v as m,O as p,E as g,Z as f,A as v,x as _,c as y,M as b,T as x,L as k,G as h,U as w}from"./index-D0wN_fuZ.js";import{_ as V}from"./RForm.vue_vue_type_script_setup_true_lang-HqTuq9xx.js";import{C as j}from"./categories.model-D6QCCUkg.js";import{_ as C}from"./RButton.vue_vue_type_style_index_0_lang-DWca47Ax.js";import{R}from"./index-CFoXpmaN.js";import{_ as U}from"./RSelect.vue_vue_type_script_setup_true_lang-C-HhWqQ_.js";import{_ as E}from"./REditor.vue_vue_type_style_index_0_lang-B9q55COs.js";import{a as M}from"./index-DEby8QZG.js";import{C as S}from"./RestBase-6hwWqa7t.js";const A={class:"r-container-form"},F={class:"mt-10 sm:mt-0"},I={class:"shadow overflow-hidden sm:rounded-md"},L={class:"px-4 py-5 bg-white dark:bg-slate-800 sm:p-6"},q={class:"grid grid-cols-4 gap-4"},K={class:"grid-input"},N={class:"flex items-start justify-center"},z={class:"grid grid-col-1"},B=["src"],D={key:1,class:"flex flex-col items-center justify-center"},G=[_("div",{class:"i-heroicons:plus-circle insert-field-icon mr-2"},null,-1),_("div",{class:"ant-upload-text mt-3"},"Subir Imagen",-1)],O={class:"grid-input"},T={class:"grid-input"},P={class:"grid-input"},X={class:"col-span-4"},Y={class:"px-4 py-3 bg-gray-50 dark:bg-slate-700 dark:bg-opacity-70 text-right sm:px-6"},Z={class:"r-footer-form"},$={class:"flex"},H={key:0,class:"flex-none items-center"},J=[_("label",{for:"andNew",class:"font-bold text-gray-700 dark:text-slate-200 !cursor-pointer"},[k("Insertar y nuevo "),_("span",{id:"andNew-description",class:"ml-1 text-muted"},"Se insertará un elemento y reiniciará el formuario")],-1)],Q={class:"r-footer-button-form"},W=e({__name:"CategoriesForm",props:a({modal:l.bool.def(!1),action:l.string.def("create"),loading_text:l.string.def(""),showLoading:l.bool.def(!0)},{modelValue:{},modelModifiers:{}}),emits:a(["closeModal","reload"],["update:modelValue"]),setup(e,{emit:a}){const l=s(),W=e,ee=a,ae="create"==W.action?"Crear":"Actualizar",le=t(e,"modelValue"),se=o(new j(le.value)),te=i(),oe=i(!1),{loading:ie,result:re}=j.useGetMany(),{loading:de,toggleEnabled:ne,onResult:ce,enabled:ue,onError:me}=j.useStaticSave(se,{defaultEnabled:!1}),pe=r((()=>ie.value)),ge=()=>{W.modal?ee("closeModal"):l.push({name:"categories_list"})};async function fe(){var e;await(null==(e=te.value)?void 0:e.validate())&&(ne(),ee("reload"))}me((e=>{d("error","Error en accion","Error en accion del elemento")})),ce((e=>{var a;d("success","Accion  "+ae,"Accion ejecutada correctamente"),oe.value?(null==(a=te.value)||a.clear(),ue.value=!1,Object.assign(se,new j(le.value)),W.modal&&ee("reload")):W.modal?ee("closeModal",!0):l.push({name:"categories_list"})}));const ve=e=>!1,_e=e=>{let a=new FileReader;a.onload=function(e){document.getElementById("avatar").setAttribute("src",e.target.result)},a.readAsDataURL(e.file),se.image=e.file,se.category_image=e.file,se.isFormData=!0};return(a,l)=>{const s=M,t=S;return n(),c(w,null,[e.showLoading?(n(),u(f,{key:0,"h-full":!0,class:"",loading:g(pe),description:W.loading_text},{default:m((()=>[p(a.$slots,"loading_icon")])),_:3},8,["loading","description"])):v("",!0),_("div",A,[_("div",F,[_("div",I,[y(V,{ref_key:"categoriesForm",ref:te,state:g(se),validations:g(j).validations[e.action],feedbacks:g(j).feedbacks[e.action],loading:!0},{default:m((()=>{var a;return[_("div",L,[_("div",q,[_("div",K,[_("div",N,[_("div",z,[y(s,{name:"image",listType:"picture-card",style:{display:"inline-table"},showUploadList:!1,beforeUpload:ve,onChange:_e},{default:m((()=>[g(se).category_image?(n(),c("img",{key:0,id:"avatar",class:"h-full w-full",src:g(se).category_image,alt:"Image"},null,8,B)):(n(),c("div",D,G))])),_:1})])])]),_("div",O,[y(U,{modelValue:g(se).category_id,"onUpdate:modelValue":l[0]||(l[0]=e=>g(se).category_id=e),"id-key":"id","required-mark":!0,ref:"selectId","loading-data":g(ie),loading:g(ie),"text-key":"name",allowClear:!0,showFilter:"",items:null==(a=g(re))?void 0:a.data,label:"Categoria Padre",onKeyup:b(fe,["enter"])},null,8,["modelValue","loading-data","loading","items"])]),_("div",T,[y(g(R),{type:"text",requiredMark:!0,modelValue:g(se).name,"onUpdate:modelValue":l[1]||(l[1]=e=>g(se).name=e),path:"name",label:"Nombre",onKeyup:b(fe,["enter"])},null,8,["modelValue"])]),_("div",P,[y(g(R),{type:"text",modelValue:g(se).slug,"onUpdate:modelValue":l[2]||(l[2]=e=>g(se).slug=e),path:"slug",label:"Slug",onKeyup:b(fe,["enter"])},null,8,["modelValue"])]),_("div",X,[y(E,{requiredMark:!0,modelValue:g(se).description,"onUpdate:modelValue":l[3]||(l[3]=e=>g(se).description=e),path:"description",label:"Descripción"},null,8,["modelValue"])])])]),_("div",Y,[_("div",Z,[_("div",$,["create"===e.action?(n(),c("div",H,[y(t,{checked:g(oe),"onUpdate:checked":l[4]||(l[4]=e=>x(oe)?oe.value=e:null),"aria-describedby":"offers-description",id:"andNew"},null,8,["checked"])])):v("",!0),"create"===e.action?(n(),c("div",{key:1,onClick:l[5]||(l[5]=e=>g(oe).value!=g(oe).value),class:"flex text-sm absolute mx-[2rem] my-[4px]"},J)):v("",!0)]),_("div",Q,[y(C,{class:"ml-5",shadow:"",color:"primary",loading:g(de),onClick:fe},{default:m((()=>[k(h(g(ae))+" Categorias ",1)])),_:1},8,["loading"]),y(C,{class:"ml-5",shadow:"",color:"primary",onClick:ge},{default:m((()=>[k(" Cancelar ")])),_:1})])])])]})),_:1},8,["state","validations","feedbacks"])])])])],64)}}});export{W as _};
