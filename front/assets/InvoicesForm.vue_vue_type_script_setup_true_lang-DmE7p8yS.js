var e=Object.defineProperty,a=(a,t,l)=>((a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l)(a,"symbol"!=typeof t?t+"":t,l);import{d as t,X as l,h as d,j as i,Y as o,k as r,r as s,a as n,S as c,n as u,z as p,q as _,v as m,O as y,E as v,Z as h,A as b,x as g,c as f,M as x,T as k,L as V,G as w,U as q}from"./index-D0wN_fuZ.js";import{_ as I}from"./RForm.vue_vue_type_script_setup_true_lang-HqTuq9xx.js";import{R as U,C as j}from"./RestBase-6hwWqa7t.js";import{r as C,i as M,d as K,m as R,R as E}from"./index-CFoXpmaN.js";import{d as N}from"./debounceValidator-Cl5zTG4a.js";import{d as O}from"./index-brT4NzTB.js";import{_ as P}from"./RButton.vue_vue_type_style_index_0_lang-DWca47Ax.js";import{_ as S}from"./RDatePicker.vue_vue_type_style_index_0_lang-C7kumIjJ.js";import{_ as A}from"./RSelect.vue_vue_type_script_setup_true_lang-C-HhWqQ_.js";import{_ as T}from"./REditor.vue_vue_type_style_index_0_lang-B9q55COs.js";import{O as F}from"./orders.model-DOfVaMlt.js";const L=[{title:"Code",dataIndex:"code",align:"center",key:"code",sorter:(e,a)=>+(e.code>a.code)-+(e.code<a.code)},{title:"Year",dataIndex:"year",align:"center",key:"year",sorter:(e,a)=>e.year-a.year},{title:"Phone",dataIndex:"phone",align:"center",key:"phone",sorter:(e,a)=>+(e.phone>a.phone)-+(e.phone<a.phone)},{title:"Address",dataIndex:"address",align:"center",key:"address",sorter:(e,a)=>+(e.address>a.address)-+(e.address<a.address)},{title:"Subtotal",dataIndex:"subtotal",align:"center",key:"subtotal"},{title:"Total",dataIndex:"total",align:"center",key:"total"},{title:"Pay_way",dataIndex:"pay_way",align:"center",key:"pay_way",sorter:(e,a)=>+(e.pay_way>a.pay_way)-+(e.pay_way<a.pay_way)},{title:"Observations",dataIndex:"observations",align:"center",key:"observations",sorter:(e,a)=>+(e.observations>a.observations)-+(e.observations<a.observations)},{title:"Invoice_date",dataIndex:"invoice_date",align:"center",key:"invoice_date",sorter:(e,a)=>e.invoice_date-a.invoice_date},{title:"Order",dataIndex:"order.code",align:"center",key:"order.code",customRender(e){var a;return null==(a=e.record.order)?void 0:a.code},sorter:(e,a)=>e.order&&a.order?(e.order.code>a.order.code)-(e.order.code<a.order.code):0},{title:"Prefix",dataIndex:"prefix",align:"center",key:"prefix",sorter:(e,a)=>+(e.prefix>a.prefix)-+(e.prefix<a.prefix)},{title:"Discount",dataIndex:"discount",align:"center",key:"discount"},{title:"Cancelled_at",dataIndex:"cancelled_at",align:"center",key:"cancelled_at",sorter:(e,a)=>e.cancelled_at-a.cancelled_at},{title:"Cancelled_by",dataIndex:"cancelled_by",align:"center",key:"cancelled_by",sorter:(e,a)=>e.cancelled_by-a.cancelled_by},{title:"Acciones",key:"_action",fixed:"right",scopedSlots:{customRender:"_action"}}],z={create:{code:{required:C,isUnique:N((function(e,a){const{id:t,code:l}={...a.state},d=t?"update":"create";return!l||B.validate({code:l,id:t,_scenario:d,_specific:!0})}),void 0,500)},year:{required:C,integer:M},phone:{},address:{},subtotal:{required:C,decimal:K},total:{required:C,decimal:K},pay_way:{required:C},observations:{maxLength:R(65535)},invoice_date:{required:C},order_id:{required:C,integer:M},prefix:{required:C},discount:{required:C,decimal:K},cancelled_at:{},cancelled_by:{integer:M}},update:{code:{required:C,isUnique:N((function(e,a){const{id:t,code:l}={...a.state},d=t?"update":"create";return!l||B.validate({code:l,id:t,_scenario:d,_specific:!0})}),void 0,500)},year:{required:C,integer:M},phone:{},address:{},subtotal:{required:C,decimal:K},total:{required:C,decimal:K},pay_way:{required:C},observations:{maxLength:R(65535)},invoice_date:{required:C},order_id:{required:C,integer:M},prefix:{required:C},discount:{required:C,decimal:K},cancelled_at:{},cancelled_by:{integer:M}}},D=await U("invoices","manage/invoices"),Y=class extends D{constructor(e=null){super(),a(this,"id"),a(this,"code"),a(this,"year"),a(this,"phone"),a(this,"address"),a(this,"subtotal"),a(this,"total"),a(this,"pay_way"),a(this,"observations"),a(this,"invoice_date"),a(this,"order_id"),a(this,"prefix"),a(this,"discount"),a(this,"cancelled_at"),a(this,"cancelled_by"),a(this,"created_at"),a(this,"updated_at"),null!=e&&(this.id=e.id||void 0,this.code=e.code||null,this.year=e.year||null,this.phone=e.phone||null,this.address=e.address||null,this.subtotal=e.subtotal||null,this.total=e.total||null,this.pay_way=e.pay_way||null,this.observations=e.observations||null,this.invoice_date=e.invoice_date?O(e.invoice_date):null,this.order_id=e.order_id||null,this.prefix=e.prefix||null,this.discount=e.discount||null,this.cancelled_at=e.cancelled_at?O(e.cancelled_at):null,this.cancelled_by=e.cancelled_by||null,this.created_at=e.created_at?O(e.created_at):null,this.updated_at=e.updated_at?O(e.updated_at):null)}set_attributes(e=null){null!=e&&(this.id=e.id,this.code=e.code,this.year=e.year,this.phone=e.phone,this.address=e.address,this.subtotal=e.subtotal,this.total=e.total,this.pay_way=e.pay_way,this.observations=e.observations,this.invoice_date=O(e.invoice_date),this.order_id=e.order_id,this.prefix=e.prefix,this.discount=e.discount,this.cancelled_at=O(e.cancelled_at),this.cancelled_by=e.cancelled_by,this.created_at=O(e.created_at),this.updated_at=O(e.updated_at))}get_id(){return this.id}class_name(){return"Invoices"}};a(Y,"validations",z),a(Y,"feedbacks",{create:{code:{isUnique:"This code has been taken"},id:{isUnique:"This id has been taken"}},update:{code:{isUnique:"This code has been taken"},id:{isUnique:"This id has been taken"}}}),a(Y,"columns",L),a(Y,"visible_columns",Y.show_columns(["*"],!0));let B=Y;const G={class:"r-container-form"},X={class:"mt-10 sm:mt-0"},Z={class:"shadow overflow-hidden sm:rounded-md"},$={class:"px-4 py-5 bg-white dark:bg-slate-800 sm:p-6"},H={class:"grid grid-cols-4 gap-4"},J={class:"grid-input"},Q={class:"grid-input"},W={class:"grid-input"},ee={class:"grid-input"},ae={class:"grid-input"},te={class:"grid-input"},le={class:"grid-input"},de={class:"col-span-4"},ie={class:"grid-input"},oe={class:"grid-input"},re={class:"grid-input"},se={class:"grid-input"},ne={class:"grid-input"},ce={class:"grid-input"},ue={class:"px-4 py-3 bg-gray-50 dark:bg-slate-700 dark:bg-opacity-70 text-right sm:px-6"},pe={class:"r-footer-form"},_e={class:"flex"},me={key:0,class:"flex-none items-center"},ye=[g("label",{for:"andNew",class:"font-bold text-gray-700 dark:text-slate-200 !cursor-pointer"},[V("Insertar y nuevo "),g("span",{id:"andNew-description",class:"ml-1 text-muted"},"Se insertara un elemento y reiniciara el formuario")],-1)],ve={class:"r-footer-button-form"},he=t({__name:"InvoicesForm",props:l({modal:d.bool.def(!1),action:d.string.def("create"),loading_text:d.string.def(""),showLoading:d.bool.def(!0)},{modelValue:{},modelModifiers:{}}),emits:l(["closeModal","reload"],["update:modelValue"]),setup(e,{emit:a}){const t=i(),l=e,d=a,U="create"==l.action?"Crear":"Actualizar",C=o(e,"modelValue"),M=r(new B(C.value)),K=s(),R=s(!1),{loading:N,result:O}=F.useGetMany(),{loading:L,toggleEnabled:z,onResult:D,enabled:Y,onError:he}=B.useStaticSave(M,{defaultEnabled:!1}),be=n((()=>N.value)),ge=()=>{l.modal?d("closeModal"):t.push({name:"invoices_list"})};async function fe(){var e;await(null==(e=K.value)?void 0:e.validate())&&z()}return he((e=>{c("error","Error en accion","Error en accion del elemento")})),D((e=>{var a;c("success","Accion  "+U,"Accion ejecutada correctamente"),R.value?(null==(a=K.value)||a.clear(),Y.value=!1,Object.assign(M,new B(C.value)),l.modal&&d("reload")):l.modal?d("closeModal",!0):t.push({name:"invoices_list"})})),(a,t)=>{const d=j;return u(),p(q,null,[e.showLoading?(u(),_(h,{key:0,"h-full":!0,class:"",loading:v(be),description:l.loading_text},{default:m((()=>[y(a.$slots,"loading_icon")])),_:3},8,["loading","description"])):b("",!0),g("div",G,[g("div",X,[g("div",Z,[f(I,{ref_key:"invoicesForm",ref:K,state:v(M),validations:v(B).validations[e.action],feedbacks:v(B).feedbacks[e.action],loading:!0},{default:m((()=>{var a;return[g("div",$,[g("div",H,[g("div",J,[f(v(E),{type:"text",requiredMark:!0,modelValue:v(M).code,"onUpdate:modelValue":t[0]||(t[0]=e=>v(M).code=e),path:"code",label:"Code",onKeyup:x(fe,["enter"])},null,8,["modelValue"])]),g("div",Q,[f(v(E),{onlyNumbers:!0,type:"number",requiredMark:!0,modelValue:v(M).year,"onUpdate:modelValue":t[1]||(t[1]=e=>v(M).year=e),path:"year",label:"Year",onKeyup:x(fe,["enter"])},null,8,["modelValue"])]),g("div",W,[f(v(E),{type:"text",modelValue:v(M).phone,"onUpdate:modelValue":t[2]||(t[2]=e=>v(M).phone=e),path:"phone",label:"Phone",onKeyup:x(fe,["enter"])},null,8,["modelValue"])]),g("div",ee,[f(v(E),{type:"text",modelValue:v(M).address,"onUpdate:modelValue":t[3]||(t[3]=e=>v(M).address=e),path:"address",label:"Address",onKeyup:x(fe,["enter"])},null,8,["modelValue"])]),g("div",ae,[f(v(E),{onlyNumbers:!0,type:"number",requiredMark:!0,modelValue:v(M).subtotal,"onUpdate:modelValue":t[4]||(t[4]=e=>v(M).subtotal=e),path:"subtotal",label:"Subtotal",onKeyup:x(fe,["enter"])},null,8,["modelValue"])]),g("div",te,[f(v(E),{onlyNumbers:!0,type:"number",requiredMark:!0,modelValue:v(M).total,"onUpdate:modelValue":t[5]||(t[5]=e=>v(M).total=e),path:"total",label:"Total",onKeyup:x(fe,["enter"])},null,8,["modelValue"])]),g("div",le,[f(v(E),{type:"text",requiredMark:!0,modelValue:v(M).pay_way,"onUpdate:modelValue":t[6]||(t[6]=e=>v(M).pay_way=e),path:"pay_way",label:"Pay_way",onKeyup:x(fe,["enter"])},null,8,["modelValue"])]),g("div",de,[f(T,{modelValue:v(M).observations,"onUpdate:modelValue":t[7]||(t[7]=e=>v(M).observations=e),path:"observations",label:"Observations"},null,8,["modelValue"])]),g("div",ie,[f(S,{requiredMark:!0,modelValue:v(M).invoice_date,"onUpdate:modelValue":t[8]||(t[8]=e=>v(M).invoice_date=e),path:"invoice_date",label:"Invoice_date",allowClear:!0},null,8,["modelValue"])]),g("div",oe,[f(A,{modelValue:v(M).order_id,"onUpdate:modelValue":t[9]||(t[9]=e=>v(M).order_id=e),"id-key":"id","required-mark":!0,ref:"selectId","loading-data":v(N),loading:v(N),"text-key":"code",allowClear:!0,showFilter:"",items:null==(a=v(O))?void 0:a.data,label:"Orders",onKeyup:x(fe,["enter"])},null,8,["modelValue","loading-data","loading","items"])]),g("div",re,[f(v(E),{type:"text",requiredMark:!0,modelValue:v(M).prefix,"onUpdate:modelValue":t[10]||(t[10]=e=>v(M).prefix=e),path:"prefix",label:"Prefix",onKeyup:x(fe,["enter"])},null,8,["modelValue"])]),g("div",se,[f(v(E),{onlyNumbers:!0,type:"number",requiredMark:!0,modelValue:v(M).discount,"onUpdate:modelValue":t[11]||(t[11]=e=>v(M).discount=e),path:"discount",label:"Discount",onKeyup:x(fe,["enter"])},null,8,["modelValue"])]),g("div",ne,[f(S,{modelValue:v(M).cancelled_at,"onUpdate:modelValue":t[12]||(t[12]=e=>v(M).cancelled_at=e),path:"cancelled_at",label:"Cancelled_at",allowClear:!0},null,8,["modelValue"])]),g("div",ce,[f(v(E),{onlyNumbers:!0,type:"number",modelValue:v(M).cancelled_by,"onUpdate:modelValue":t[13]||(t[13]=e=>v(M).cancelled_by=e),path:"cancelled_by",label:"Cancelled_by",onKeyup:x(fe,["enter"])},null,8,["modelValue"])])])]),g("div",ue,[g("div",pe,[g("div",_e,["create"===e.action?(u(),p("div",me,[f(d,{checked:v(R),"onUpdate:checked":t[14]||(t[14]=e=>k(R)?R.value=e:null),"aria-describedby":"offers-description",id:"andNew"},null,8,["checked"])])):b("",!0),"create"===e.action?(u(),p("div",{key:1,onClick:t[15]||(t[15]=e=>v(R).value!=v(R).value),class:"flex text-sm absolute mx-[2rem] my-[4px]"},ye)):b("",!0)]),g("div",ve,[f(P,{class:"ml-5",shadow:"",color:"primary",loading:v(L),onClick:fe},{default:m((()=>[V(w(v(U))+" Invoices ",1)])),_:1},8,["loading"]),f(P,{class:"ml-5",shadow:"",color:"primary",onClick:ge},{default:m((()=>[V(" Cancelar ")])),_:1})])])])]})),_:1},8,["state","validations","feedbacks"])])])])],64)}}});export{B as I,he as _};
