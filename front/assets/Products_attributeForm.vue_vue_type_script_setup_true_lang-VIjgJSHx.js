var e=Object.defineProperty,t=(t,a,i)=>((t,a,i)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i)(t,"symbol"!=typeof a?a+"":a,i);import{d as a,X as i,h as r,j as d,Y as s,k as o,r as l,a as n,S as u,n as c,z as m,q as p,v as _,O as b,E as v,Z as g,A as f,x as h,c as y,M as k,T as x,L as w,G as j,U as q}from"./index-D0wN_fuZ.js";import{_ as R}from"./RForm.vue_vue_type_script_setup_true_lang-HqTuq9xx.js";import{R as V,C as A}from"./RestBase-6hwWqa7t.js";import{r as C,i as P}from"./index-CFoXpmaN.js";import{_ as M}from"./RButton.vue_vue_type_style_index_0_lang-DWca47Ax.js";import{_ as E}from"./RSelect.vue_vue_type_script_setup_true_lang-C-HhWqQ_.js";import{P as S}from"./products.model-Dn3jzT27.js";const U=[{title:"Product",dataIndex:"product.name",align:"center",key:"product.name",customRender(e){var t;return null==(t=e.record.product)?void 0:t.name},sorter:(e,t)=>e.product&&t.product?(e.product.name>t.product.name)-(e.product.name<t.product.name):0},{title:"Attribute",dataIndex:"attribute.name",align:"center",key:"attribute.name",customRender(e){var t;return null==(t=e.record.attribute)?void 0:t.name},sorter:(e,t)=>e.attribute&&t.attribute?(e.attribute.name>t.attribute.name)-(e.attribute.name<t.attribute.name):0},{title:"Acciones",key:"_action",fixed:"right",width:"5%",scopedSlots:{customRender:"_action"}}],F={create:{product_id:{required:C,integer:P},attribute_id:{required:C,integer:P}},update:{product_id:{required:C,integer:P},attribute_id:{required:C,integer:P}}},I=await V("products_attribute","manage/products_attribute"),L=class extends I{constructor(e=null){super(),t(this,"id"),t(this,"product_id"),t(this,"attribute_id"),null!=e&&(this.id=e.id||void 0,this.product_id=e.product_id||null,this.attribute_id=e.attribute_id||null)}set_attributes(e=null){null!=e&&(this.id=e.id,this.product_id=e.product_id,this.attribute_id=e.attribute_id)}get_id(){return this.id}class_name(){return"Products_attribute"}};t(L,"validations",F),t(L,"feedbacks",{create:{id:{isUnique:"This id has been taken"}},update:{id:{isUnique:"This id has been taken"}}}),t(L,"columns",U),t(L,"visible_columns",L.show_columns(["*"],!0));let z=L;const G={class:"r-container-form"},N={class:"mt-10 sm:mt-0"},O={class:"shadow overflow-hidden sm:rounded-md"},T={class:"px-4 py-5 bg-white dark:bg-slate-800 sm:p-6"},B={class:"grid grid-cols-4 gap-4"},K={class:"grid-input"},X={class:"grid-input"},Y={class:"px-4 py-3 bg-gray-50 dark:bg-slate-700 dark:bg-opacity-70 text-right sm:px-6"},Z={class:"r-footer-form"},$={class:"flex"},D={key:0,class:"flex-none items-center"},H=[h("label",{for:"andNew",class:"font-bold text-gray-700 dark:text-slate-200 !cursor-pointer"},[w("Insertar y nuevo "),h("span",{id:"andNew-description",class:"ml-1 text-muted"},"Se insertara un elemento y reiniciara el formuario")],-1)],J={class:"r-footer-button-form"},Q=a({__name:"Products_attributeForm",props:i({modal:r.bool.def(!1),action:r.string.def("create"),loading_text:r.string.def(""),showLoading:r.bool.def(!0)},{modelValue:{},modelModifiers:{}}),emits:i(["closeModal","reload"],["update:modelValue"]),setup(e,{emit:t}){const a=d(),i=e,r=t,V="create"==i.action?"Crear":"Actualizar",C=s(e,"modelValue"),P=o(new z(C.value)),U=l(),F=l(!1),{loading:I,result:L}=Attributes.useGetMany(),{loading:Q,result:W}=S.useGetMany(),{loading:ee,toggleEnabled:te,onResult:ae,enabled:ie,onError:re}=z.useStaticSave(P,{defaultEnabled:!1}),de=n((()=>I.value||Q.value)),se=()=>{i.modal?r("closeModal"):a.push({name:"products_attribute_list"})};async function oe(){var e;await(null==(e=U.value)?void 0:e.validate())&&te()}return re((e=>{u("error","Error en accion","Error en accion del elemento")})),ae((e=>{var t;u("success","Accion  "+V,"Accion ejecutada correctamente"),F.value?(null==(t=U.value)||t.clear(),ie.value=!1,Object.assign(P,new z(C.value)),i.modal&&r("reload")):i.modal?r("closeModal",!0):a.push({name:"products_attribute_list"})})),(t,a)=>{const r=A;return c(),m(q,null,[e.showLoading?(c(),p(g,{key:0,"h-full":!0,class:"",loading:v(de),description:i.loading_text},{default:_((()=>[b(t.$slots,"loading_icon")])),_:3},8,["loading","description"])):f("",!0),h("div",G,[h("div",N,[h("div",O,[y(R,{ref_key:"products_attributeForm",ref:U,state:v(P),validations:v(z).validations[e.action],feedbacks:v(z).feedbacks[e.action],loading:!0},{default:_((()=>{var t,i;return[h("div",T,[h("div",B,[h("div",K,[y(E,{modelValue:v(P).product_id,"onUpdate:modelValue":a[0]||(a[0]=e=>v(P).product_id=e),"id-key":"id","required-mark":!0,path:"product_id",ref:"selectId","loading-data":v(Q),loading:v(Q),"text-key":"name",allowClear:!0,showFilter:"",items:null==(t=v(W))?void 0:t.data,label:"Products",onKeyup:k(oe,["enter"])},null,8,["modelValue","loading-data","loading","items"])]),h("div",X,[y(E,{modelValue:v(P).attribute_id,"onUpdate:modelValue":a[1]||(a[1]=e=>v(P).attribute_id=e),"id-key":"id","required-mark":!0,path:"attribute_id",ref:"selectId","loading-data":v(I),loading:v(I),"text-key":"name",allowClear:!0,showFilter:"",items:null==(i=v(L))?void 0:i.data,label:"Attributes",onKeyup:k(oe,["enter"])},null,8,["modelValue","loading-data","loading","items"])])])]),h("div",Y,[h("div",Z,[h("div",$,["create"===e.action?(c(),m("div",D,[y(r,{checked:v(F),"onUpdate:checked":a[2]||(a[2]=e=>x(F)?F.value=e:null),"aria-describedby":"offers-description",id:"andNew"},null,8,["checked"])])):f("",!0),"create"===e.action?(c(),m("div",{key:1,onClick:a[3]||(a[3]=e=>v(F).value!=v(F).value),class:"flex text-sm absolute mx-[2rem] my-[4px]"},H)):f("",!0)]),h("div",J,[y(M,{class:"ml-5",shadow:"",color:"primary",loading:v(ee),onClick:oe},{default:_((()=>[w(j(v(V))+" Products_attribute ",1)])),_:1},8,["loading"]),y(M,{class:"ml-5",shadow:"",color:"primary",onClick:se},{default:_((()=>[w(" Cancelar ")])),_:1})])])])]})),_:1},8,["state","validations","feedbacks"])])])])],64)}}});export{z as P,Q as _};
